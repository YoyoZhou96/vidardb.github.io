webpackJsonp([1],{"/yRs":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,n=(r=a("8ebl")).default||r,i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"vue-street-view-pano-container"},[e("div",{ref:"vue-street-view-pano",staticClass:"vue-street-view-pano"}),this._v(" "),this._t("default")],2)},staticRenderFns:[]};var s=a("VU/8")(n,i,!1,function(t){a("uGSN")},null,null);e.default=s.exports},"5ZbH":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,n=(r=a("hOwk")).default||r,i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"vue-map-container"},[e("div",{ref:"vue-map",staticClass:"vue-map"}),this._v(" "),e("div",{staticClass:"vue-map-hidden"},[this._t("default")],2),this._v(" "),this._t("visible")],2)},staticRenderFns:[]};var s=a("VU/8")(n,i,!1,function(t){a("aNJ/")},null,null);e.default=s.exports},"5cLx":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,n=(r=a("WgA/")).default||r,i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{ref:"flyaway"},[this._t("default")],2)])},staticRenderFns:[]},s=a("VU/8")(n,i,!1,null,null,null);e.default=s.exports},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("7+uW"),n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var i=a("VU/8")({name:"App"},n,!1,function(t){a("oHNY")},null,null).exports,s=a("/ocq"),o=a("//Fk"),l=a.n(o),c=a("mtWM"),u=a.n(c),d=a("mw3O"),p=a.n(d),h=a("zL8q"),f=a.n(h),m=u.a.create({timeout:6e4,baseURL:"https://api.vidardb.com/"});m.interceptors.request.use(function(t){return t},function(t){return h.Message.error({message:"Request timeout!"}),l.a.reject(t)}),m.interceptors.response.use(function(t){return t.data},function(t){if(t.response){if(306===t.response.status){var e=t.response.data+"&version=v3&callback="+encodeURIComponent(window.location.href);return void(window.location=e)}504===t.response.status||404===t.response.status?h.Message.error({message:"Server Internal Error, Please contact admin!"}):403===t.response.status?h.Message.error({message:"Perm Error, Please contact admin!"}):400===t.response.status&&console.log(t.response.data)}else h.Message.error({message:"Unknown Error!"});return l.a.resolve(t.response)});var v={post:function(t,e){return new l.a(function(a,r){return m({method:"post",baseURL:"https://api.vidardb.com/",url:t,data:p.a.stringify(e)||"",withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){a(t)}).catch(function(t){console.log(t),r(t)})})},get:function(t,e,a){return void 0===a&&(a=!0),new l.a(function(r,n){return m({method:"get",url:t,params:e,withCredentials:a,headers:{"Content-Type":"application/json"}}).then(function(t){r(t)}).catch(function(t){console.log(t),n(t)})})},fileRequest:function(t,e){return new l.a(function(a,r){m({method:"post",url:t,data:p.a.stringify(e)||"",headers:{"Content-Type":"multipart/form-data"}}).then(function(t){a(t)}).catch(function(t){console.log(t),r(t)})})}};var g=a("XNC2"),_=a("spco"),b=a.n(_),k=a("BO1k"),w=a.n(k),y=a("sA6N"),T={name:"GoogleMap",props:["dataToGoogleMap"],data:function(){return{center:{lat:41.881832,lng:-87.623177},markers:[],dataFromParentComp:[]}},computed:{google:y.gmapApi},watch:{dataToGoogleMap:function(t){var e=this;this.dataFromParentComp&&t&&(this.dataFromParentComp=t,this.markers.length=0,this.dataFromParentComp.forEach(function(t){var a=t.mark,r=t.id,n=void 0;n="0"===r?"red":"1"===r?"blue":"2"===r?"orange":"3"===r?"green":"4"===r?"yellow":"black",e.addMarker(a,n)}))},markers:function(t){if(t.length>2){var e=new this.google.maps.LatLngBounds,a=!0,r=!1,n=void 0;try{for(var i,s=w()(this.markers);!(a=(i=s.next()).done);a=!0){var o=i.value;e.extend(o.position)}}catch(t){r=!0,n=t}finally{try{!a&&s.return&&s.return()}finally{if(r)throw n}}this.$refs.map.fitBounds(e)}}},mounted:function(){},methods:{addMarker:function(t,e){var a="http://maps.google.com/mapfiles/ms/icons/";a+=e+"-dot.png";var r={lat:t[0],lng:t[1]};this.markers.push({position:r,icon:a})},clean:function(){this.markers.length=0}}},S={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("gmap-map",{ref:"map",staticStyle:{width:"100%",height:"400px"},attrs:{center:this.center,zoom:12}},this._l(this.markers,function(t,a){return e("gmap-marker",{key:a,attrs:{position:t.position,icon:t.icon}})}),1)],1)},staticRenderFns:[]},x=a("VU/8")(T,S,!1,null,null,null).exports;g.a.register("currency",b.a);var I={name:"VidarDbDemo",components:{GoogleMap:x},data:function(){return this.theme={line:{smooth:!0}},this.extend={series:{smooth:!0}},this.grid={left:15,right:35},this.markLine={data:[{name:"average",type:"average"}]},this.markPoint={data:[{name:"max",type:"max"}]},this.vchartsLineConfig={legendName:{fare:"maximum trip fare"},legend:{y:"bottom",x:"center"},yAxisType:["$ 0,0.00"],dataType:function(t){return t+" $"}},{msg:"Welcome to VidarDB demo App",taskId:"",interval_id:0,biChartData:{columns:["trip_start_timestamp","fare"],rows:[]},biSqlData:[],rawTableData:[],aiTableData:[],aiSqlData:[],biSql:[],aiSql:[],disableStopBtn:!1,srcBiImg:"",srcAiImg:"",center:[],dataToGoogleMap:[],screenWidth:document.body.clientWidth}},mounted:function(){var t=this;window.onresize=function(){return window.screenWidth=document.body.clientWidth,void(t.screenWidth=window.screenWidth)}},created:function(){var t=this;this.taskId=localStorage.getItem("task_id"),this.taskId&&0===this.interval_id?(this.fetchTaskResult(this.taskId),this.interval_id=setInterval(function(){t.fetchTaskResult(t.taskId)},5e3)):this.disableStopBtn=!0},methods:{fetchTaskResult:function(t){var e,a=this;(e={task_id:t},v.get("/api/v1/task/taskId/result",e)).then(function(t){0===t.code?(a.biChartData.rows=t.data.bi,a.aiTableData=t.data.ai,a.sendDataToGoogleMap(),a.rawTableData=t.data.raw,a.biSql=t.data.biSql,a.aiSql=t.data.aiSql,a.srcBiImg="../assets/static/max.jpg",a.srcAiImg="../assets/static/kmeans.jpg","finish"===t.data.status?(a.disableStopBtn=!0,a.$notify.success({message:"The task is finished.",duration:5e3}),clearInterval(a.interval_id),a.interval_id=0):a.disableStopBtn=!1):(a.$notify.error({title:"Error",message:t.data}),clearInterval(a.interval_id),a.interval_id=0)})},beforeDestroy:function(){clearInterval(this.interval_id),this.interval_id=0},start:function(){var t,e=this;this.interval_id>0?this.$notify.warning("There are already tasks running."):v.post("/auth/v1/task/create",t).then(function(t){0===t.code?(e.$notify.success("Create task success"),e.taskId=t.data.task_id,localStorage.setItem("task_id",e.taskId),e.fetchTaskResult(e.taskId),e.interval_id=setInterval(function(){e.fetchTaskResult(e.taskId)},5e3)):e.$notify.error({title:"Error",message:t.data})})},stop:function(){var t,e=this;(t={task_id:this.taskId},v.post("/auth/v1/task/stop",t)).then(function(t){0===t.code?(e.$notify.success("Stop task success"),clearInterval(e.interval_id),e.interval_id=0,e.disableStopBtn=!0,localStorage.removeItem("task_id")):e.$notify.error({title:"Error",message:t.data})})},sendDataToGoogleMap:function(){var t=[];this.aiTableData&&this.aiTableData.forEach(function(e){var a=e.row_vec.replace("{","").replace("}","").split(",").map(function(t){return+t}),r=e.cluster_id;t.push({mark:a,id:r})}),this.dataToGoogleMap=t},pickUpLocationFormatter:function(t){var e=t.row_vec.replace("{","").replace("}","").split(",");return e[0].substring(0,7)+", "+e[1].substring(0,8)},tripFareFormatter:function(t){return"$"+t.fare}}},C={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return this.screenWidth>=1e3?a("div",{staticClass:"vidardb"},[t._m(0),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:14}},[a("span",{staticStyle:{"font-weight":"bold"}},[t._v("Maximum Trip Fare Updated Every 100 Records")])]),t._v(" "),a("el-col",{attrs:{span:10}},[a("span",{staticStyle:{"font-weight":"bold"}},[t._v("Data Flow of Taxi Trip Orders")])])],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:14}},[a("div",{staticStyle:{border:"1px solid #EBEEF5"}},[a("ve-line",{attrs:{data:t.biChartData,extend:t.extend,grid:t.grid,"mark-line":t.markLine,settings:t.vchartsLineConfig,"mark-point":t.markPoint}})],1)]),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-table",{attrs:{data:t.rawTableData.slice(-9),"header-cell-style":{background:"#eef1f6",color:"#606266"},stripe:"",border:"",align:"center"}},[a("el-table-column",{attrs:{prop:"trip_start_timestamp",label:"Trip Start Time","min-width":"25%",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"taxi_id",label:"Taxi ID","min-width":"11%",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"row_vec",label:"Pickup Location",formatter:t.pickUpLocationFormatter,"min-width":"25%",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"fare",label:"Fare",formatter:t.tripFareFormatter,"min-width":"9%",align:"center"}})],1)],1)],1),t._v(" "),a("br"),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:14}},[a("span",{staticStyle:{"font-weight":"bold"}},[t._v("Clustering of Pickup Location")])])],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:14}},[a("div",{staticStyle:{height:"400px"}},[a("google-map",{attrs:{"data-to-google-map":this.dataToGoogleMap}})],1)]),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-row",[a("div",{staticStyle:{height:"50%"}},[a("el-table",{attrs:{data:t.biSql,"header-cell-style":{background:"#eef1f6",color:"#606266"},"highlight-current-row":"",stripe:"",borde:""}},[a("el-table-column",{attrs:{prop:"value",label:"Maximum Trip Fare"}},[a("highlight-code",{staticStyle:{margin:"-1% auto -1% auto"},attrs:{lang:"sql"}},[t._v("SELECT MAX(FARE) FROM CHICAGO_TAXI_TRIPS WHERE TRIP_START_TIMESTAMP > LAST_VISITED;")])],1)],1),t._v(" "),a("br"),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.aiSql,"header-cell-style":{background:"#eef1f6",color:"#606266"},stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"value",label:"Clustering Pickup Location (Running KMeans Algorithm)","min-width":"60"}},[a("highlight-code",{staticStyle:{margin:"-1% auto -1% auto"},attrs:{lang:"sql"}},[t._v("\n              CREATE TABLE km_result AS SELECT * FROM madlib.kmeanspp(\n                  'chicago_taxi_trips_change',   -- Table of source data\n                  'row_vec',                     -- Column containing point co-ordinates\n                  5,                             -- Number of centroids to calculate\n                  'madlib.squared_dist_norm2',   -- Distance function\n                  'madlib.avg',                  -- Aggregate function\n                  20,                            -- Number of iterations\n                  0.001                          -- Fraction of centroids reassigned to keep iterating\n              );")])],1)],1)],1)]),t._v(" "),a("el-row",[a("div",{staticStyle:{align:"center",margin:"2% auto 0 auto"}},[a("el-button",{staticStyle:{"margin-right":"30px"},attrs:{type:"primary",round:""},on:{click:t.start}},[t._v("start")]),t._v(" "),a("el-button",{attrs:{type:"danger",disabled:t.disableStopBtn,round:""},on:{click:t.stop}},[t._v("stop")])],1)])],1)],1)],1):a("div",[t._v("\n  Your screen's weight does not meet our minimum requirement. Please try to rotate it or use a bigger one to see our demo.\n")])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{"text-align":"left","margin-bottom":"2%"}},[e("span",[this._v("This demo simluates a console for Uber-like companies collecting realtime taxi data of Chicago. The system calculates the maximum and average trip fares online, which are instructional to taxi drivers. Additionally, in order to improve revenue, it is useful to point out taxi drivers the increasingly hot areas with customers by clustering the pickup locations recorded in real-time.")]),this._v(" "),e("span",[this._v("Dataset used: "),e("a",{attrs:{href:"https://data.cityofchicago.org/Transportation/Taxi-Trips/wrvz-psew"}},[this._v("Chicago Taxi Trip")])])])}]};var E=a("VU/8")(I,C,!1,function(t){a("v60D")},"data-v-5bda753e",null).exports;r.default.use(s.a);var M=new s.a({routes:[{path:"/",name:"VidarDbDemo",component:E}]}),R=a("vO7p"),F=a.n(R),D=(a("Qbfk"),a("tvR6"),a("wUZ8")),A=a.n(D),P=a("7H7j"),$=a("8IMK"),q=a.n($);a("c/gx");r.default.config.productionTip=!1,r.default.use(f.a,{size:"small",locale:A.a}),r.default.use(F.a),r.default.prototype.$axios=u.a,r.default.use(y,{load:{key:"AIzaSyCqu8xFvtQPTKbKEbd7fJ2zBCNZ02d01I0"}}),r.default.use(P.a,{languages:{sql:q.a}}),new r.default({el:"#app",router:M,components:{App:i},template:"<App/>"})},Qbfk:function(t,e){},T5eZ:function(t,e,a){"use strict";var r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("label",[e("span",{domProps:{textContent:this._s(this.label)}}),this._v(" "),e("input",{ref:"input",class:this.className,attrs:{type:"text",placeholder:this.placeholder}})])},staticRenderFns:[]};e.a=r},YI6p:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("jIen"),n=a.n(r);for(var i in r)"default"!==i&&function(t){a.d(e,t,function(){return r[t]})}(i);var s=a("T5eZ"),o=a("VU/8")(n.a,s.a,!1,null,null,null);e.default=o.exports},"aNJ/":function(t,e){},"c/gx":function(t,e){},oHNY:function(t,e){},preG:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,n=(r=a("hQTS")).default||r,i={render:function(){var t=this.$createElement;return(this._self._c||t)("input",this._g(this._b({ref:"input"},"input",this.$attrs,!1),this.$listeners))},staticRenderFns:[]},s=a("VU/8")(n,i,!1,null,null,null);e.default=s.exports},tvR6:function(t,e){},uGSN:function(t,e){},v60D:function(t,e){}},["NHnr"]);